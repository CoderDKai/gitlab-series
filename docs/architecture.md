# GitLab ç³»åˆ—å…¨æ ˆæ¶æ„æ–‡æ¡£

## 1. å¼•è¨€

æœ¬æ–‡æ¡£æ¦‚è¿°äº† GitLab ç³»åˆ—è¾…åŠ©å·¥å…·å¥—ä»¶çš„å®Œæ•´æ¶æ„ã€‚è¯¥å¥—ä»¶æ—¨åœ¨é€šè¿‡**åŠè‡ªåŠ¨åŒ–**æ–¹å¼ä¼˜åŒ–ä¼ä¸š GitLab å·¥ä½œæµï¼Œåœ¨æé«˜æ•ˆç‡çš„åŒæ—¶ä¿ç•™ç”¨æˆ·çš„æ§åˆ¶æƒã€‚

**æ ¸å¿ƒç†å¿µï¼š**
- ğŸ¯ **åŠè‡ªåŠ¨åŒ–**ï¼šè¾…åŠ©è€Œéæ›¿ä»£ï¼Œç”¨æˆ·ä¿æŒæœ€ç»ˆå†³ç­–æƒ
- ğŸš€ **æ¸è¿›å¼é‡‡ç”¨**ï¼šä»æ²¹çŒ´è„šæœ¬å¼€å§‹ï¼ŒæŒ‰éœ€æ‰©å±•åˆ°å…¶ä»–ç«¯ç‚¹
- ğŸ’¾ **æœ¬åœ°ä¼˜å…ˆ**ï¼šæ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œé€šè¿‡ JSON å¯¼å…¥/å¯¼å‡ºå®ç°é…ç½®å…±äº«
- ğŸ”§ **å®ç”¨ä¸»ä¹‰**ï¼šè§£å†³æ—¥å¸¸ç—›ç‚¹ï¼Œä¸è¿‡åº¦è®¾è®¡

### 1.1 é¡¹ç›®èŒƒå›´
- **ç¬¬ä¸€é˜¶æ®µ**ï¼šæ²¹çŒ´è„šæœ¬ï¼ˆTampermonkeyï¼‰- MR å¢å¼ºåŠŸèƒ½
- **æœªæ¥æ‰©å±•**ï¼šæµè§ˆå™¨æ‰©å±•ã€VSCode æ‰©å±•ã€æ¡Œé¢åº”ç”¨

### 1.2 æŠ€æœ¯å†³ç­–
- **Monorepo æ¶æ„**ï¼šä½¿ç”¨ pnpm workspace ç®¡ç†ä»£ç 
- **å…±äº«åŒ…ç­–ç•¥**ï¼šæå–å…¬å…±é€»è¾‘åˆ° @coderdkai/gitlab-* åŒ…
- **æ•°æ®ç®¡ç†**ï¼šæœ¬åœ°å­˜å‚¨ + JSON é…ç½®å¯¼å…¥/å¯¼å‡º

### 1.3 èµ·å§‹æ¨¡æ¿æˆ–ç°æœ‰é¡¹ç›®
**çŠ¶æ€ï¼š** ä¸é€‚ç”¨ - å…¨æ–°é¡¹ç›®

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ pnpm workspace æ¶æ„ç®¡ç†å¤šä¸ªåº”ç”¨å’Œå…±äº«åŒ…çš„æ–° monorepo é¡¹ç›®ã€‚

### 1.4 å˜æ›´æ—¥å¿—

| æ—¥æœŸ | ç‰ˆæœ¬ | æè¿° | ä½œè€… |
|------|---------|-------------|--------|
| 2024-12-19 | v1.0 | åˆå§‹æ¶æ„æ–‡æ¡£åˆ›å»º | Winstonï¼ˆæ¶æ„å¸ˆï¼‰|

## 2. é«˜å±‚æ¶æ„

### 2.1 æŠ€æœ¯æ‘˜è¦

GitLab ç³»åˆ—é‡‡ç”¨**æ¸è¿›å¼å®¢æˆ·ç«¯æ¶æ„**ï¼Œé€šè¿‡ monorepo ç®¡ç†å¤šä¸ªç‹¬ç«‹ä½†å…±äº«æ ¸å¿ƒé€»è¾‘çš„å®¢æˆ·ç«¯åº”ç”¨ã€‚é¦–æœŸèšç„¦æ²¹çŒ´è„šæœ¬å®ç°å¿«é€Ÿä»·å€¼äº¤ä»˜ï¼Œåç»­æ‰©å±•åˆ°æµè§ˆå™¨æ‰©å±•ã€VSCode æ‰©å±•å’Œæ¡Œé¢åº”ç”¨ã€‚æ‰€æœ‰ç«¯ç‚¹å…±äº« GitLab API å°è£…ã€ç¼“å­˜ç­–ç•¥å’Œå·¥å…·å‡½æ•°ï¼Œé€šè¿‡ pnpm workspace å®ç°ä»£ç å¤ç”¨ã€‚æ¶æ„å¼ºè°ƒåŠè‡ªåŠ¨åŒ–ç†å¿µï¼Œåœ¨æå‡æ•ˆç‡çš„åŒæ—¶ä¿ç•™ç”¨æˆ·æ§åˆ¶æƒï¼Œé‡‡ç”¨æœ¬åœ°å­˜å‚¨ç­–ç•¥é…åˆ JSON å¯¼å…¥/å¯¼å‡ºå®ç°é…ç½®å…±äº«ã€‚

### 2.2 å¹³å°å’ŒåŸºç¡€è®¾æ–½é€‰æ‹©

**å¹³å°ï¼š** çº¯å®¢æˆ·ç«¯æ¶æ„
**å…³é”®æœåŠ¡ï¼š** æ— éœ€äº‘æœåŠ¡ï¼Œæ‰€æœ‰é€»è¾‘åœ¨å®¢æˆ·ç«¯æ‰§è¡Œ
**éƒ¨ç½²æ–¹å¼ï¼š** 
- æ²¹çŒ´è„šæœ¬ï¼šGreasy Fork å‘å¸ƒ
- æµè§ˆå™¨æ‰©å±•ï¼šChrome/Edge Web Store
- VSCode æ‰©å±•ï¼šVS Code Marketplace
- æ¡Œé¢åº”ç”¨ï¼šGitHub Releases

### 2.3 ä»“åº“ç»“æ„

**ç»“æ„ï¼š** Monorepo
**Monorepo å·¥å…·ï¼š** pnpm workspace
**åŒ…ç»„ç»‡ç­–ç•¥ï¼š** 
- `apps/*` - å„ç«¯åº”ç”¨
- `packages/*` - å…±äº«åŒ…
- æ¯ä¸ªåŒ…ç‹¬ç«‹æ„å»ºå’Œç‰ˆæœ¬ç®¡ç†

### 2.4 é«˜å±‚æ¶æ„å›¾

```mermaid
graph TB
    subgraph "ç”¨æˆ·å…¥å£"
        U1[GitLab ç½‘é¡µ]
        U2[VSCode ç¼–è¾‘å™¨]
        U3[æ¡Œé¢ç¯å¢ƒ]
    end
    
    subgraph "åº”ç”¨å±‚"
        A1[æ²¹çŒ´è„šæœ¬]
        A2[æµè§ˆå™¨æ‰©å±•]
        A3[VSCode æ‰©å±•]
        A4[æ¡Œé¢åº”ç”¨]
    end
    
    subgraph "å…±äº«åŒ…å±‚"
        P1[@coderdkai/gitlab-api]
        P2[@coderdkai/gitlab-cache]
        P3[@coderdkai/gitlab-utils]
        P4[@coderdkai/gitlab-types]
        P5[@coderdkai/gitlab-components]
    end
    
    subgraph "å¤–éƒ¨ç³»ç»Ÿ"
        G[GitLab API]
        S[æœ¬åœ°å­˜å‚¨]
    end
    
    U1 --> A1
    U1 --> A2
    U2 --> A3
    U3 --> A4
    
    A1 --> P1
    A1 --> P2
    A1 --> P3
    A1 --> P4
    A1 --> P5
    
    A2 --> P1
    A2 --> P2
    A2 --> P3
    A2 --> P4
    A2 --> P5
    
    A3 --> P1
    A3 --> P3
    A3 --> P4
    
    A4 --> P1
    A4 --> P2
    A4 --> P3
    A4 --> P4
    A4 --> P5
    
    P1 --> G
    P2 --> S
    
    style A1 fill:#90EE90
    style P1 fill:#87CEEB
    style P2 fill:#87CEEB
    style P3 fill:#87CEEB
    style P4 fill:#87CEEB
    style P5 fill:#87CEEB
```

### 2.5 UIç»„ä»¶å¤ç”¨ç­–ç•¥

ä¸ºäº†åœ¨å¤šç«¯ä¿æŒç•Œé¢ä¸€è‡´æ€§å¹¶æœ€å¤§åŒ–ä»£ç å¤ç”¨ï¼Œæˆ‘ä»¬é‡‡ç”¨ç»Ÿä¸€çš„UIç»„ä»¶åŒ…ç­–ç•¥ï¼š

**@coderdkai/gitlab-components** ä½œä¸ºæ ¸å¿ƒUIåŒ…ï¼Œæä¾›ï¼š

- **åŸºç¡€UIç»„ä»¶**ï¼šåŸºäº `shadcn-vue` çš„é€šç”¨ç»„ä»¶ï¼ˆButtonã€Inputã€Dialogç­‰ï¼‰
- **ä¸šåŠ¡ç»„ä»¶**ï¼šGitLabç‰¹å®šçš„ç»„ä»¶ï¼ˆMRCardã€UserAvatarã€PriorityBadgeç­‰ï¼‰  
- **Vueç»„åˆå¼å‡½æ•°**ï¼šè·¨ç«¯å…±äº«çš„é€»è¾‘ï¼ˆuseMRã€useFilterã€useConfigç­‰ï¼‰
- **ç»Ÿä¸€æ ·å¼**ï¼šTailwind CSSé…ç½®å’Œå…¨å±€æ ·å¼

**å„ç«¯é€‚é…ç­–ç•¥**ï¼š
- **æ²¹çŒ´è„šæœ¬ + æµè§ˆå™¨æ‰©å±•**ï¼šç›´æ¥ä½¿ç”¨Vueç»„ä»¶ï¼Œé€šè¿‡Shadow DOMéš”ç¦»æ ·å¼
- **æ¡Œé¢åº”ç”¨**ï¼šå®Œæ•´ä½¿ç”¨æ‰€æœ‰ç»„ä»¶å’Œæ ·å¼
- **VSCodeæ‰©å±•**ï¼šä»…ä½¿ç”¨ç»„åˆå¼å‡½æ•°å’Œå·¥å…·ç±»ï¼ŒUIé‡‡ç”¨VSCodeåŸç”Ÿç»„ä»¶

### 2.6 æ¶æ„æ¨¡å¼

- **Monorepo æ¨¡å¼ï¼š** ç»Ÿä¸€ä»£ç ç®¡ç†ï¼Œä¾¿äºå…±äº«å’Œé‡æ„ - *ç†ç”±ï¼š* æœ€å¤§åŒ–ä»£ç å¤ç”¨ï¼Œç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†
- **åˆ†å±‚æ¶æ„ï¼š** åº”ç”¨å±‚ã€å…±äº«åŒ…å±‚ã€å¤–éƒ¨æ¥å£å±‚æ¸…æ™°åˆ†ç¦» - *ç†ç”±ï¼š* å…³æ³¨ç‚¹åˆ†ç¦»ï¼Œä¾¿äºç»´æŠ¤å’Œæµ‹è¯•
- **é€‚é…å™¨æ¨¡å¼ï¼š** ç»Ÿä¸€çš„ GitLab API é€‚é…å™¨å±è”½ç‰ˆæœ¬å·®å¼‚ - *ç†ç”±ï¼š* åº”å¯¹ä¸åŒ GitLab ç‰ˆæœ¬çš„ API å·®å¼‚
- **æœ¬åœ°ä¼˜å…ˆæ¨¡å¼ï¼š** æ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæ— éœ€æœåŠ¡å™¨ - *ç†ç”±ï¼š* ä¿æŠ¤éšç§ï¼Œé™ä½è¿ç»´æˆæœ¬
- **æ¸è¿›å¢å¼ºæ¨¡å¼ï¼š** ä»ç®€å•åŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥æ·»åŠ é«˜çº§ç‰¹æ€§ - *ç†ç”±ï¼š* å¿«é€Ÿäº¤ä»˜ä»·å€¼ï¼Œé™ä½é£é™©
- **æ’ä»¶åŒ–æ¶æ„ï¼š** æ¯ä¸ªç«¯ç‚¹ç‹¬ç«‹ä½†å…±äº«æ ¸å¿ƒ - *ç†ç”±ï¼š* çµæ´»éƒ¨ç½²ï¼ŒæŒ‰éœ€ä½¿ç”¨
- **ç»„ä»¶å¤ç”¨æ¶æ„ï¼š** ç»Ÿä¸€çš„UIç»„ä»¶åŒ…è·¨ç«¯å…±äº« - *ç†ç”±ï¼š* ä¿æŒç•Œé¢ä¸€è‡´æ€§ï¼Œå‡å°‘é‡å¤å¼€å‘

## 3. æŠ€æœ¯æ ˆ

è¿™æ˜¯æ•´ä¸ªé¡¹ç›®çš„**æƒå¨æŠ€æœ¯é€‰æ‹©**ã€‚æ‰€æœ‰å¼€å‘å¿…é¡»ä½¿ç”¨è¿™äº›ç¡®åˆ‡ç‰ˆæœ¬ã€‚

### æŠ€æœ¯æ ˆè¡¨

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” | é€‰æ‹©ç†ç”± |
|------|------|------|------|----------|
| å‰ç«¯è¯­è¨€ | TypeScript | 5.3+ | æ‰€æœ‰å®¢æˆ·ç«¯å¼€å‘ | ç±»å‹å®‰å…¨ï¼Œæ›´å¥½çš„ IDE æ”¯æŒ |
| æ²¹çŒ´æ¡†æ¶ | Tampermonkey API | - | æ²¹çŒ´è„šæœ¬å¼€å‘ | æœ€å¹¿æ³›æ”¯æŒçš„ç”¨æˆ·è„šæœ¬ç®¡ç†å™¨ |
| æ‰©å±•æ¡†æ¶ | Plasmo | 0.84+ | æµè§ˆå™¨æ‰©å±•å¼€å‘ | ç°ä»£åŒ–çš„æ‰©å±•å¼€å‘æ¡†æ¶ |
| VSCode SDK | VS Code Extension API | 1.85+ | VSCode æ‰©å±•å¼€å‘ | å®˜æ–¹ API |
| æ¡Œé¢æ¡†æ¶ | Tauri | 1.5+ | æ¡Œé¢åº”ç”¨ | Rust åç«¯ï¼Œæ€§èƒ½å¥½ï¼ŒåŒ…ä½“å° |
| å‰ç«¯æ¡†æ¶ | Vue 3 | 3.4+ | å¤šç«¯UIå¼€å‘ | ç†Ÿæ‚‰åº¦é«˜ï¼Œç”Ÿæ€å®Œå–„ |
| UIç»„ä»¶ç­–ç•¥ | å…±äº«ç»„ä»¶åŒ… | - | è·¨ç«¯UIå¤ç”¨ | @coderdkai/gitlab-components ç»Ÿä¸€ç®¡ç† |
| UI ç»„ä»¶åº“ | shadcn-vue | - | å…±äº«UIç»„ä»¶åŸºç¡€ | ç°ä»£åŒ–UIç»„ä»¶åº“ï¼ŒåŸºäºRadix Vueå’ŒTailwind CSS |
| çŠ¶æ€ç®¡ç† | Pinia | 2.1+ | æ¡Œé¢åº”ç”¨çŠ¶æ€ | Vue 3 å®˜æ–¹æ¨è |
| åç«¯è¯­è¨€ | TypeScript | 5.3+ | Node.js å·¥å…·é“¾ | ç»Ÿä¸€è¯­è¨€æ ˆ |
| API é£æ ¼ | RESTful | - | GitLab API è°ƒç”¨ | GitLab åŸç”Ÿæ”¯æŒ |
| æ•°æ®åº“ | - | - | ä¸éœ€è¦ | çº¯å®¢æˆ·ç«¯æ¶æ„ |
| ç¼“å­˜ | localStorage/IndexedDB | - | æµè§ˆå™¨ç«¯ç¼“å­˜ | æµè§ˆå™¨åŸç”Ÿæ”¯æŒ |
| æ–‡ä»¶å­˜å‚¨ | æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ | - | é…ç½®å¯¼å‡º | å®¢æˆ·ç«¯æœ¬åœ°å­˜å‚¨ |
| è®¤è¯ | GitLab Token | - | API è®¤è¯ | Personal Access Token |
| å‰ç«¯æµ‹è¯• | Vitest | 1.0+ | å•å…ƒæµ‹è¯• | å¿«é€Ÿï¼Œä¸ Vite é›†æˆå¥½ |
| E2E æµ‹è¯• | Playwright | 1.40+ | ç«¯åˆ°ç«¯æµ‹è¯• | æ”¯æŒå¤šæµè§ˆå™¨ |
| æ„å»ºå·¥å…· | Vite | 5.0+ | åº”ç”¨æ„å»º | å¿«é€Ÿçš„å¼€å‘ä½“éªŒ |
| æ‰“åŒ…å·¥å…· | Rollup | 4.0+ | åº“æ‰“åŒ… | Vite åº•å±‚ï¼Œé€‚åˆåº“å¼€å‘ |
| åŒ…ç®¡ç† | pnpm | 8.0+ | ä¾èµ–ç®¡ç† | èŠ‚çœç£ç›˜ï¼Œæ”¯æŒ workspace |
| CI/CD | GitHub Actions | - | è‡ªåŠ¨åŒ–æ„å»º | å…è´¹ï¼Œä¸ GitHub é›†æˆ |
| ä»£ç è§„èŒƒ | ESLint + Prettier | æœ€æ–° | ä»£ç è´¨é‡ | ç»Ÿä¸€ä»£ç é£æ ¼ |
| CSS æ¡†æ¶ | Tailwind CSS | 3.4+ | åŸå­åŒ– CSS | æˆç†Ÿçš„å·¥å…·ä¼˜å…ˆCSSæ¡†æ¶ï¼Œç”Ÿæ€å®Œå–„ |

## 4. æ•°æ®æ¨¡å‹

### 4.1 æ ¸å¿ƒæ•°æ®ç±»å‹

```typescript
// åŸºç¡€ GitLab å®ä½“
interface GitLabProject {
  id: number;
  name: string;
  path: string;
  web_url: string;
  namespace: {
    id: number;
    name: string;
    path: string;
  };
}

interface GitLabUser {
  id: number;
  username: string;
  name: string;
  avatar_url: string;
  web_url: string;
}

// MRï¼ˆMerge Requestï¼‰æ•°æ®ç»“æ„
interface MergeRequest {
  id: number;
  iid: number;
  title: string;
  description: string;
  state: 'opened' | 'closed' | 'merged';
  source_branch: string;
  target_branch: string;
  author: GitLabUser;
  assignees: GitLabUser[];
  reviewers: GitLabUser[];
  web_url: string;
  created_at: string;
  updated_at: string;
  merged_at?: string;
  // æ‰©å±•å­—æ®µï¼ˆæˆ‘ä»¬çš„å¢å¼ºæ•°æ®ï¼‰
  enhancement?: {
    priority: 'low' | 'normal' | 'high' | 'urgent';
    tags: string[];
    notes: string;
    estimatedHours?: number;
  };
}

// ç”¨æˆ·é…ç½®æ¨¡å‹
interface UserConfig {
  // GitLab è¿æ¥é…ç½®
  gitlab: {
    baseUrl: string;
    accessToken: string;
    defaultProject?: string;
  };
  
  // UI åå¥½è®¾ç½®
  preferences: {
    theme: 'light' | 'dark' | 'auto';
    language: 'zh-CN' | 'en-US';
    notifications: {
      enabled: boolean;
      types: ('mr_created' | 'mr_merged' | 'review_requested')[];
    };
  };
  
  // å·¥ä½œæµé…ç½®
  workflow: {
    autoAssignReviewer: boolean;
    defaultReviewers: string[];
    mrTemplate: string;
    branchNamingConvention: string;
  };
}

// ç¼“å­˜æ•°æ®ç»“æ„
interface CacheEntry<T> {
  data: T;
  timestamp: number;
  expiry: number;
  key: string;
}

interface CacheStore {
  projects: CacheEntry<GitLabProject[]>;
  users: CacheEntry<GitLabUser[]>;
  mergeRequests: Record<string, CacheEntry<MergeRequest[]>>;
}
```

### 4.2 çŠ¶æ€ç®¡ç†æ¨¡å‹

```typescript
// Pinia Store çŠ¶æ€å®šä¹‰
interface AppState {
  // è®¤è¯çŠ¶æ€
  auth: {
    isAuthenticated: boolean;
    user: GitLabUser | null;
    token: string | null;
  };
  
  // å½“å‰é€‰ä¸­çš„é¡¹ç›®
  currentProject: GitLabProject | null;
  
  // MR åˆ—è¡¨å’Œè¿‡æ»¤çŠ¶æ€
  mergeRequests: {
    list: MergeRequest[];
    loading: boolean;
    error: string | null;
    filters: {
      state: string[];
      assignee: string[];
      reviewer: string[];
      label: string[];
    };
  };
  
  // ç”¨æˆ·è®¾ç½®
  config: UserConfig;
}
```

## 5. API è§„èŒƒï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†å®šä¹‰ GitLab API çš„å°è£…æ¥å£_

## 6. ç»„ä»¶è®¾è®¡ï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†è¯¦ç»†è¯´æ˜å„ä¸ªç»„ä»¶çš„èŒè´£å’Œæ¥å£_

## 7. å¤–éƒ¨ APIï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†è®°å½•ä½¿ç”¨çš„ GitLab API ç«¯ç‚¹_

## 8. æ ¸å¿ƒå·¥ä½œæµ

### 8.1 ç”¨æˆ·è®¤è¯æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as åº”ç”¨
    participant C as é…ç½®å­˜å‚¨
    participant G as GitLab API
    
    U->>A: å¯åŠ¨åº”ç”¨
    A->>C: è¯»å–æœ¬åœ°é…ç½®
    alt é¦–æ¬¡ä½¿ç”¨
        C-->>A: æ— é…ç½®
        A->>U: æ˜¾ç¤ºé…ç½®å‘å¯¼
        U->>A: è¾“å…¥ GitLab URL å’Œ Token
        A->>G: éªŒè¯ Token
        G-->>A: è¿”å›ç”¨æˆ·ä¿¡æ¯
        A->>C: ä¿å­˜é…ç½®
    else å·²é…ç½®
        C-->>A: è¿”å›é…ç½®
        A->>G: éªŒè¯ Token æœ‰æ•ˆæ€§
        G-->>A: ç¡®è®¤æœ‰æ•ˆ
    end
    A->>U: è¿›å…¥ä¸»ç•Œé¢
```

### 8.2 MR å¢å¼ºå·¥ä½œæµ

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant T as æ²¹çŒ´è„šæœ¬
    participant S as æœ¬åœ°å­˜å‚¨
    participant G as GitLab
    
    U->>G: è®¿é—® GitLab MR é¡µé¢
    G-->>U: åŠ è½½åŸç”Ÿ MR é¡µé¢
    T->>T: æ£€æµ‹ MR é¡µé¢
    T->>S: è¯»å–å¢å¼ºæ•°æ®
    T->>T: æ³¨å…¥å¢å¼º UI ç»„ä»¶
    
    alt æ·»åŠ ä¼˜å…ˆçº§æ ‡ç­¾
        U->>T: ç‚¹å‡»è®¾ç½®ä¼˜å…ˆçº§
        T->>U: æ˜¾ç¤ºä¼˜å…ˆçº§é€‰æ‹©å™¨
        U->>T: é€‰æ‹©ä¼˜å…ˆçº§
        T->>S: ä¿å­˜å¢å¼ºæ•°æ®
        T->>T: æ›´æ–° UI æ˜¾ç¤º
    end
    
    alt æ‰¹é‡æ“ä½œ
        U->>T: é€‰æ‹©å¤šä¸ª MR
        T->>U: æ˜¾ç¤ºæ‰¹é‡æ“ä½œé¢æ¿
        U->>T: æ‰§è¡Œæ‰¹é‡æ“ä½œ
        loop å¯¹æ¯ä¸ªé€‰ä¸­çš„ MR
            T->>G: è°ƒç”¨ GitLab API
            G-->>T: è¿”å›æ“ä½œç»“æœ
        end
        T->>U: æ˜¾ç¤ºæ“ä½œç»“æœ
    end
```

### 8.3 é…ç½®åŒæ­¥å·¥ä½œæµ

```mermaid
sequenceDiagram
    participant U1 as ç”¨æˆ·A
    participant A1 as è®¾å¤‡1åº”ç”¨
    participant F as æœ¬åœ°æ–‡ä»¶
    participant U2 as ç”¨æˆ·B
    participant A2 as è®¾å¤‡2åº”ç”¨
    
    U1->>A1: å®Œæˆä¸ªæ€§åŒ–é…ç½®
    A1->>A1: ç§¯ç´¯ä½¿ç”¨æ•°æ®
    U1->>A1: å¯¼å‡ºé…ç½®
    A1->>F: ç”Ÿæˆé…ç½® JSON æ–‡ä»¶
    
    note over F: ç”¨æˆ·é€šè¿‡ä»»æ„æ–¹å¼ä¼ è¾“æ–‡ä»¶<br/>(é‚®ä»¶ã€äº‘ç›˜ã€Uç›˜ç­‰)
    
    U2->>A2: å¯¼å…¥é…ç½®
    A2->>F: è¯»å–é…ç½® JSON
    A2->>A2: åº”ç”¨é…ç½®è®¾ç½®
    A2->>U2: é…ç½®å¯¼å…¥å®Œæˆ
```

### 8.4 ç¦»çº¿ä¼˜å…ˆå·¥ä½œæµ

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as åº”ç”¨
    participant C as ç¼“å­˜å±‚
    participant G as GitLab API
    
    U->>A: è¯·æ±‚ MR åˆ—è¡¨
    A->>C: æ£€æŸ¥ç¼“å­˜
    
    alt ç¼“å­˜å‘½ä¸­ä¸”æœªè¿‡æœŸ
        C-->>A: è¿”å›ç¼“å­˜æ•°æ®
        A-->>U: æ˜¾ç¤º MR åˆ—è¡¨
        A->>G: åå°åˆ·æ–°æ•°æ®
        G-->>A: è¿”å›æœ€æ–°æ•°æ®
        A->>C: æ›´æ–°ç¼“å­˜
        A->>U: é™é»˜æ›´æ–° UI
    else ç¼“å­˜è¿‡æœŸæˆ–æ— ç¼“å­˜
        C-->>A: ç¼“å­˜è¿‡æœŸ/æ— æ•°æ®
        A-->>U: æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        A->>G: è¯·æ±‚æœ€æ–°æ•°æ®
        alt ç½‘ç»œæ­£å¸¸
            G-->>A: è¿”å›æ•°æ®
            A->>C: æ›´æ–°ç¼“å­˜
            A-->>U: æ˜¾ç¤ºæœ€æ–°æ•°æ®
        else ç½‘ç»œå¼‚å¸¸
            G-->>A: è¯·æ±‚å¤±è´¥
            A->>C: å°è¯•è¿”å›è¿‡æœŸç¼“å­˜
            alt æœ‰è¿‡æœŸç¼“å­˜
                C-->>A: è¿”å›è¿‡æœŸæ•°æ®
                A-->>U: æ˜¾ç¤ºè¿‡æœŸæ•°æ®+ç¦»çº¿æç¤º
            else æ— ç¼“å­˜
                A-->>U: æ˜¾ç¤ºç¦»çº¿é”™è¯¯é¡µé¢
            end
        end
    end
```

### 8.5 è·¨ç«¯æ•°æ®ä¸€è‡´æ€§

```mermaid
graph TD
    subgraph "æ•°æ®å±‚æ¬¡"
        D1[GitLab æœåŠ¡å™¨æ•°æ®]
        D2[æœ¬åœ°å¢å¼ºæ•°æ®]
        D3[ç”¨æˆ·é…ç½®æ•°æ®]
    end
    
    subgraph "åŒæ­¥ç­–ç•¥"
        S1[å®æ—¶åŒæ­¥ - GitLab API]
        S2[æœ¬åœ°å­˜å‚¨ - å¢å¼ºæ•°æ®]
        S3[å¯¼å…¥/å¯¼å‡º - é…ç½®æ•°æ®]
    end
    
    subgraph "å†²çªè§£å†³"
        R1[æœåŠ¡å™¨ä¼˜å…ˆ - åŸºç¡€æ•°æ®]
        R2[æœ¬åœ°ä¼˜å…ˆ - å¢å¼ºæ•°æ®]
        R3[ç”¨æˆ·é€‰æ‹© - é…ç½®å†²çª]
    end
    
    D1 --> S1 --> R1
    D2 --> S2 --> R2
    D3 --> S3 --> R3
```

## 9. é¡¹ç›®ç»“æ„

### 9.1 Monorepo ç›®å½•ç»“æ„

```
gitlab-series/
â”œâ”€â”€ README.md
â”œâ”€â”€ package.json                    # æ ¹åŒ…ç®¡ç†
â”œâ”€â”€ pnpm-workspace.yaml            # pnpm workspace é…ç½®
â”œâ”€â”€ tsconfig.json                   # æ ¹ TypeScript é…ç½®
â”œâ”€â”€ .eslintrc.js                    # ESLint é…ç½®
â”œâ”€â”€ .prettierrc                     # Prettier é…ç½®
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/                  # GitHub Actions CI/CD
â”‚       â”œâ”€â”€ build.yml
â”‚       â”œâ”€â”€ test.yml
â”‚       â””â”€â”€ release.yml
â”œâ”€â”€ docs/                           # é¡¹ç›®æ–‡æ¡£
â”‚   â”œâ”€â”€ architecture.md
â”‚   â”œâ”€â”€ development.md
â”‚   â””â”€â”€ deployment.md
â”‚
â”œâ”€â”€ apps/                           # å„ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ tampermonkey/              # æ²¹çŒ´è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ main.ts           # å…¥å£æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ components/       # Vue ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ stores/           # Pinia çŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ styles/           # Tailwind CSS æ ·å¼
â”‚   â”‚   â””â”€â”€ dist/                 # æ„å»ºè¾“å‡º
â”‚   â”‚
â”‚   â”œâ”€â”€ browser-extension/         # æµè§ˆå™¨æ‰©å±•
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ plasmo.config.ts
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ popup/           # å¼¹å‡ºçª—å£
â”‚   â”‚   â”‚   â”œâ”€â”€ content/         # å†…å®¹è„šæœ¬
â”‚   â”‚   â”‚   â”œâ”€â”€ background/      # åå°è„šæœ¬
â”‚   â”‚   â”‚   â””â”€â”€ options/         # é€‰é¡¹é¡µé¢
â”‚   â”‚   â””â”€â”€ build/               # æ„å»ºè¾“å‡º
â”‚   â”‚
â”‚   â”œâ”€â”€ vscode-extension/         # VSCode æ‰©å±•
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ extension.ts     # æ‰©å±•å…¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ commands/        # å‘½ä»¤å¤„ç†
â”‚   â”‚   â”‚   â””â”€â”€ providers/       # å„ç§æä¾›è€…
â”‚   â”‚   â””â”€â”€ out/                 # ç¼–è¯‘è¾“å‡º
â”‚   â”‚
â”‚   â””â”€â”€ desktop/                  # æ¡Œé¢åº”ç”¨ (Tauri + Vue)
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ vite.config.ts
â”‚       â”œâ”€â”€ src-tauri/           # Rust åç«¯
â”‚       â”‚   â”œâ”€â”€ Cargo.toml
â”‚       â”‚   â”œâ”€â”€ src/
â”‚       â”‚   â”‚   â””â”€â”€ main.rs
â”‚       â”‚   â””â”€â”€ tauri.conf.json
â”‚       â”œâ”€â”€ src/                 # Vue å‰ç«¯
â”‚       â”‚   â”œâ”€â”€ main.ts
â”‚       â”‚   â”œâ”€â”€ App.vue
â”‚       â”‚   â”œâ”€â”€ components/      # shadcn-vue ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ stores/          # Pinia çŠ¶æ€ç®¡ç†
â”‚       â”‚   â”œâ”€â”€ views/           # é¡µé¢ç»„ä»¶
â”‚       â”‚   â””â”€â”€ assets/          # é™æ€èµ„æº
â”‚       â””â”€â”€ dist/                # æ„å»ºè¾“å‡º
â”‚
â”œâ”€â”€ packages/                      # å…±äº«åŒ…
â”‚   â”œâ”€â”€ types/                    # @coderdkai/gitlab-types
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts           # API å“åº”ç±»å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ config.ts        # é…ç½®ç±»å‹
â”‚   â”‚   â”‚   â””â”€â”€ models.ts        # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ dist/
â”‚   â”‚
â”‚   â”œâ”€â”€ components/               # @coderdkai/gitlab-components
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts         # ç»„ä»¶å¯¼å‡º
â”‚   â”‚   â”‚   â”œâ”€â”€ ui/              # åŸºç¡€UIç»„ä»¶ï¼ˆåŸºäºshadcn-vueï¼‰
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Input/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Select/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Dialog/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Badge/
â”‚   â”‚   â”‚   â”œâ”€â”€ business/        # ä¸šåŠ¡ç»„ä»¶
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MRCard/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ UserAvatar/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PriorityBadge/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ StatusIndicator/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ FilterPanel/
â”‚   â”‚   â”‚   â”œâ”€â”€ composables/     # Vue ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useMR.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ useFilter.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ useConfig.ts
â”‚   â”‚   â”‚   â””â”€â”€ styles/          # å…±äº«æ ·å¼
â”‚   â”‚   â”‚       â”œâ”€â”€ globals.css
â”‚   â”‚   â”‚       â””â”€â”€ components.css
â”‚   â”‚   â”œâ”€â”€ tailwind.config.js   # Tailwind é…ç½®
â”‚   â”‚   â””â”€â”€ dist/
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                      # @coderdkai/gitlab-api
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ client.ts        # API å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ endpoints/       # API ç«¯ç‚¹å°è£…
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ projects.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ merge-requests.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ users.ts
â”‚   â”‚   â”‚   â””â”€â”€ auth.ts          # è®¤è¯å¤„ç†
â”‚   â”‚   â””â”€â”€ dist/
â”‚   â”‚
â”‚   â”œâ”€â”€ cache/                    # @coderdkai/gitlab-cache
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ memory-cache.ts   # å†…å­˜ç¼“å­˜
â”‚   â”‚   â”‚   â”œâ”€â”€ local-storage.ts  # æœ¬åœ°å­˜å‚¨ç¼“å­˜
â”‚   â”‚   â”‚   â””â”€â”€ indexed-db.ts     # IndexedDB ç¼“å­˜
â”‚   â”‚   â””â”€â”€ dist/
â”‚   â”‚
â”‚   â””â”€â”€ utils/                    # @coderdkai/gitlab-utils
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ index.ts
â”‚       â”‚   â”œâ”€â”€ date.ts          # æ—¥æœŸå·¥å…·
â”‚       â”‚   â”œâ”€â”€ validation.ts    # éªŒè¯å·¥å…·
â”‚       â”‚   â”œâ”€â”€ formatting.ts    # æ ¼å¼åŒ–å·¥å…·
â”‚       â”‚   â””â”€â”€ constants.ts     # å¸¸é‡å®šä¹‰
â”‚       â””â”€â”€ dist/
â”‚
â”œâ”€â”€ tools/                        # å¼€å‘å·¥å…·
â”‚   â”œâ”€â”€ build-scripts/           # æ„å»ºè„šæœ¬
â”‚   â”œâ”€â”€ dev-server/              # æœ¬åœ°å¼€å‘æœåŠ¡å™¨
â”‚   â””â”€â”€ testing/                 # æµ‹è¯•å·¥å…·
â”‚
â””â”€â”€ tests/                       # é›†æˆæµ‹è¯•
    â”œâ”€â”€ e2e/                     # ç«¯åˆ°ç«¯æµ‹è¯•
    â””â”€â”€ integration/             # é›†æˆæµ‹è¯•
```

### 9.2 åŒ…ä¾èµ–å…³ç³»

```mermaid
graph TD
    subgraph "Applications"
        A1[tampermonkey]
        A2[browser-extension]
        A3[vscode-extension]
        A4[desktop]
    end
    
    subgraph "Shared Packages"
        P1[@coderdkai/gitlab-types]
        P2[@coderdkai/gitlab-api]
        P3[@coderdkai/gitlab-cache]
        P4[@coderdkai/gitlab-utils]
        P5[@coderdkai/gitlab-components]
    end
    
    A1 --> P1
    A1 --> P2
    A1 --> P3
    A1 --> P4
    A1 --> P5
    
    A2 --> P1
    A2 --> P2
    A2 --> P3
    A2 --> P4
    A2 --> P5
    
    A3 --> P1
    A3 --> P2
    A3 --> P4
    
    A4 --> P1
    A4 --> P2
    A4 --> P3
    A4 --> P4
    A4 --> P5
    
    P2 --> P1
    P3 --> P1
    P4 --> P1
    P5 --> P1
    P5 --> P4
```

### 9.3 é…ç½®æ–‡ä»¶

#### pnpm-workspace.yaml
```yaml
packages:
  - 'apps/*'
  - 'packages/*'
  - 'tools/*'
```

#### æ ¹ package.json
```json
{
  "name": "gitlab-series",
  "private": true,
  "scripts": {
    "build": "pnpm -r build",
    "dev": "pnpm -r --parallel dev",
    "test": "pnpm -r test",
    "lint": "pnpm -r lint",
    "clean": "pnpm -r clean",
    "release": "changeset publish"
  },
  "devDependencies": {
    "@changesets/cli": "^2.26.0",
    "typescript": "^5.3.0",
    "eslint": "^8.55.0",
    "prettier": "^3.1.0"
  }
}
```

## 10. å¼€å‘å·¥ä½œæµï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†å®šä¹‰æœ¬åœ°å¼€å‘è®¾ç½®å’Œæµç¨‹_

## 11. éƒ¨ç½²æ¶æ„ï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†è¯´æ˜å„ç«¯ç‚¹çš„å‘å¸ƒæµç¨‹_

## 12. å®‰å…¨å’Œæ€§èƒ½ï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†å®šä¹‰å®‰å…¨ç­–ç•¥å’Œæ€§èƒ½ç›®æ ‡_

## 13. æµ‹è¯•ç­–ç•¥ï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†åˆ¶å®šæµ‹è¯•è®¡åˆ’å’Œæ ‡å‡†_

## 14. ç¼–ç æ ‡å‡†ï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†å®šä¹‰é¡¹ç›®ç‰¹å®šçš„ç¼–ç è§„èŒƒ_

## 15. é”™è¯¯å¤„ç†ï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†å®šä¹‰ç»Ÿä¸€çš„é”™è¯¯å¤„ç†ç­–ç•¥_

## 16. ç›‘æ§å’Œå¯è§‚æµ‹æ€§ï¼ˆå¾…å®Œå–„ï¼‰

_æ­¤éƒ¨åˆ†å°†è¯´æ˜æ—¥å¿—å’Œç›‘æ§æ–¹æ¡ˆ_

---

*æ–‡æ¡£çŠ¶æ€ï¼šæ¶æ„æ ¸å¿ƒéƒ¨åˆ†å·²å®Œå–„ï¼ŒæŠ€æœ¯æ ˆå·²æ›´æ–°*
*æœ€åæ›´æ–°ï¼š2024-12-19*
*å®Œæˆå†…å®¹ï¼šæ•°æ®æ¨¡å‹ã€æ ¸å¿ƒå·¥ä½œæµã€é¡¹ç›®ç»“æ„*
*ä¸‹ä¸€æ­¥ï¼šAPI è§„èŒƒã€ç»„ä»¶è®¾è®¡ã€å®‰å…¨æ€§èƒ½ç­‰ä¸“é¡¹ç« èŠ‚*

### æ›´æ–°æ‘˜è¦

**å·²å®Œæˆç« èŠ‚ï¼š**
- âœ… ç¬¬4ç« ï¼šæ•°æ®æ¨¡å‹ - å®Œæ•´çš„ TypeScript æ¥å£å®šä¹‰
- âœ… ç¬¬8ç« ï¼šæ ¸å¿ƒå·¥ä½œæµ - å…³é”®ç”¨æˆ·æµç¨‹çš„åºåˆ—å›¾
- âœ… ç¬¬9ç« ï¼šé¡¹ç›®ç»“æ„ - è¯¦ç»†çš„ Monorepo ç›®å½•ç»“æ„

**æŠ€æœ¯æ ˆæ›´æ–°ï¼š**
- âœ… UIç»„ä»¶åº“ï¼šElement Plus â†’ **shadcn-vue**
- âœ… CSSæ¡†æ¶ï¼šUnoCSS â†’ **Tailwind CSS**

**ä»éœ€å®Œå–„çš„ç« èŠ‚ï¼š**
- ç¬¬5ç« ï¼šAPI è§„èŒƒ - GitLab API å°è£…æ¥å£
- ç¬¬6ç« ï¼šç»„ä»¶è®¾è®¡ - å„æ¨¡å—èŒè´£å’Œæ¥å£
- ç¬¬7ç« ï¼šå¤–éƒ¨ API - GitLab API ç«¯ç‚¹æ¸…å•
- ç¬¬10-16ç« ï¼šå¼€å‘æµç¨‹ã€éƒ¨ç½²ã€å®‰å…¨ã€æµ‹è¯•ç­‰




